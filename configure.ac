AC_PREREQ([2.61])
AC_INIT([atem], [0.3.3], [http://www.ga-group.nl/])
AC_CONFIG_AUX_DIR([.])
AC_CONFIG_HEADER([src/config.h])
AC_CONFIG_SRCDIR([src/])

AM_INIT_AUTOMAKE([foreign parallel-tests color-tests])

## compiler check
CXXFLAGS="-O3 -g -Wall -W"
AC_PROG_CXX
AC_PROG_CC_C_O
AC_PROG_CC_C99


## tweaks
AC_ARG_ENABLE([fast-printing],[
AS_HELP_STRING([--disable-fast-printing],
    [Use slow but safe printing methods (sprintf). Default: enabled])],
	enable_fast_printing=${enableval}, enable_fast_printing="yes")
if test "${enable_fast_printing}" = "yes"; then
    AC_DEFINE([FAST_PRINTING], [1], [Define if fast printing is preferred.])
fi

## uterus
PKG_CHECK_MODULES([uterus], [libuterus >= 0.2], [have_uterus="yes"], [:])
pushdef([ute_test], [test "${have_uterus}" = "yes"])
if []ute_test[]; then
	AC_DEFINE([HAVE_UTERUS], [1], [Define when uterus is present])
fi
AM_CONDITIONAL([HAVE_UTERUS], []ute_test[])
popdef([ute_test])


AM_MISSING_PROG([HELP2MAN], [help2man], ["${missing_dir}"])

## output
AC_CONFIG_FILES([Makefile])
AC_CONFIG_FILES([src/Makefile])
AC_CONFIG_FILES([doc/Makefile])
AC_CONFIG_FILES([test/Makefile])
AC_OUTPUT

